{% extends "layout.html" %}

{% block title %}
    COOP Discover
{% endblock %}

{% block main %}
    <head>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    </head>
    <main class="px-3">
        <h1>Discover and explore similar coop games</h1>
        <p class="lead">Just type the name of a coop game you like and we'll find 10 similar games!</p>
      </main>
      <form action="/search" method="post" class="container">
        <div class="row">
            <div class="mb-3">
                <label for="title" class="form-label">Game Title:</label>
                <input autocomplete="off" autofocus class="form-control" id="title" name="title" type="text" placeholder="Enter game title">
            </div>
            <div class="b-divider"></div>
            <p>Filter results:</p>
            <div class="col-md-3 mb-3">
                <label for="release-date-start" class="form-label">Start Year:</label>
                <input type="number" class="form-control" id="release-date-start" name="release-date-start" min="2006" max="2023" value="2006">
            </div>
            <div class="col-md-3 mb-3">
                <label for="release-date-end" class="form-label">End Year:</label>
                <input type="number" class="form-control" id="release-date-end" name="release-date-end" min="2006" max="2023" value="2023">
            </div>
            <div class="col-md-3 mb-3">
                <label for="min-reviews" class="form-label">Minimum number of reviews:</label>
                <input type="number" class="form-control" id="min-reviews" name="min-reviews" min="0" max="90000" value="0">
            </div>
            <div class="col-md-3 mb-3">
                <label for="min-score-rate" class="form-label">Minimum Score Rate:</label>
                <input type="number" class="form-control" id="min-score-rate" name="min-score-rate" min="0" max="10" step="0.1" value="0.0">
            </div>
            <div class="col-md-3 mb-3">
                <label for="price" class="form-label">Price:</label>
                <select class="form-select" id="num-players" name="num-players">
                    <option value="">Any</option>
                    <option value="paid">Paid</option>
                    <option value="free">Free</option>
                </select>
            </div>     
        </div>
        <div class="row">
            <div class="mb-3">
                <label class="form-label">Select Languages:</label>
                <div class="row">
                    {% for i in range(3) %}
                        <div class="col-md-4">
                            {% for j in range(i*11, (i+1)*11) %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="{{ languages[j] }}" id="{{ languages[j] }}" name="selected-languages[]">
                                    <label class="form-check-label">
                                        {{ languages[j] }}
                                    </label>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="mb-lg-3">
                <div class="b-divider"></div>
                <button class="btn btn-primary" type="submit">Search</button>
            </div>
        </div>
    </form>
    <script>
        $(function() {
            $('#title').autocomplete({
                source: function(request, response) {
                    $.ajax({
                        url: '/complete',
                        method: 'POST',
                        data: {
                            search: request.term
                        },
                        dataType: 'json',
                        success: function(data) {
                            response(data); 
                        }
                    });
                },
                minLength: 2
            });
        });
    </script>       
{% endblock %}