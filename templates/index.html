{% extends "layout.html" %}

{% block title %}
COOP Discover
{% endblock %}

{% block main %}

<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
</head>
<main class="px-3">
    <h1>Discover and explore similar coop games</h1>
    <p class="lead">Just type the name of a coop game you like and we'll find 10 similar games!</p>
    <div class="b-divider" style="height: 30px;"></div>
</main>
<form action="/search" method="post" class="container">
    <div class="row">
        <div class="mb-3">
            <label for="title" class="form-label tooltip-parent">Game Title:
                <span class="tooltip-text">Note that not all Steam games are present in this database.</span>
            </label>
            <input autocomplete="off" autofocus class="form-control" id="title" name="title" type="text"
                placeholder="Enter game title">
        </div>
        <div class="b-divider" style="height: 30px;"></div>
        <p class="tooltip-parent">Filter results:
            <span class="tooltip-text">This will filter games, note that it's not always accurate.</span>
        </p>
        <div class="b-divider" style="height: 30px;"></div>
        <div class="col-md-4 mb-1">
            <label for="release-date-start" class="form-label tooltip-parent">Start Year:
                <span class="tooltip-text">This will filter games that have been released before this year.</span>
            </label>
            <input type="number" class="form-control" id="release-date-start" name="release-date-start" min="2006"
                max="2023" value="2006">
        </div>
        <div class="col-md-4 mb-1">
            <label for="release-date-end" class="form-label tooltip-parent">End Year:
                <span class="tooltip-text">This will filter games that have been released after this year.</span>
            </label>
            <input type="number" class="form-control" id="release-date-end" name="release-date-end" min="2006"
                max="2023" value="2023">
        </div>
        <div class="col-md-4 mb-3">
            <label for="min-reviews" class="form-label tooltip-parent">Minimum number of reviews:
                <span class="tooltip-text">This will filter games that don't have this minimum number of reviews.</span>
            </label>
            <input type="number" class="form-control" id="min-reviews" name="min-reviews" min="0" max="90000" value="0">
        </div>
        <div class="col-md-4 mb-3">
            <label for="min-score-rate" class="form-label tooltip-parent">*Minimum Score Rate:
                <span class="tooltip-text">This will filter games that don't have this minimum score rate (this isn't
                    always accurate).</span>
            </label>
            <input type="number" class="form-control" id="min-score-rate" name="min-score-rate" min="0" max="10"
                step="0.1" value="0.0">
        </div>
        <div class="col-md-4 mb-3">
            <label for="price" class="form-label tooltip-parent">*Price:
                <span class="tooltip-text">This will filter games based on price (this isn't
                    always accurate).</span>
            </label>
            <select class="form-select" id="max_price" name="max_price">
                <option value="">Any</option>
                <option value="paid">Paid</option>
                <option value="free">Free</option>
            </select>
        </div>
        <div class="col-md-4 mb-3">
            <label for="recommendations_count" class="form-label tooltip-parent">Recommendations Count:
            </label>
            <input type="number" class="form-control" id="recommendations_count" name="recommendations_count" min="10"
                max="10000" step="1" value="10">
        </div>
    </div>
    <div class="row">
        <div class="mb-lg-3">
            <div class="b-divider"></div>
            <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </div>
    <div class="b-divider" style="height: 13.5vh;"></div>
</form>
<script>
    $(function () {
        $('#title').autocomplete({
            source: function (request, response) {
                fetch('/complete', {
                    method: 'POST',
                    headers: new Headers({
                        'Content-Type': 'application/json'
                    }),
                    body: JSON.stringify({
                        search: request.term
                    })
                }).then(async function (data) {
                    response(await data.json());
                });
            },
            minLength: 2
        });
    });
</script>
{% endblock %}